---
layout: post

title: æ€ä¹ˆç”¨å®éªŒå®¤çš„å·¥ä½œç«™ï¼Ÿâ€”â€”VScodeè¿œç¨‹å¼€å‘è°ƒè¯•

categories: PyTorch

description: è¿œç¨‹æ·±åº¦å­¦ä¹ å¼€å‘

---

äº‹å®è¯æ˜ï¼Œå®éªŒå®¤è™½ç„¶ç»™æ¯ä¸ªäººé…äº†3060ï¼Œä½†æ˜¯æœ¬èœèœçš„ç ”ç©¶ç”Ÿç¯å¢ƒè‡³ä»Šè¿˜æ˜¯æ²¡å®Œå…¨è£…å¥½â€”â€”GPTå’Œä¸€äº›NLPæ¨¡å‹è·‘å¾—æ²¡é—®é¢˜ï¼Œä½†æ˜¯æœ€è¿‘è·‘CVæ¨¡å‹â€”â€”YOLOä¸åœæŠ¥é”™ï¼Œæ­£åœ¨å´©æºƒä¸­ğŸ˜­ï¼ˆåæ¥å‘ç°æ˜¯æ˜¾å­˜ä¸å¤Ÿï¼ŒæŠŠbatch sizeæ”¹å°ï¼‰ã€‚å®éªŒå®¤çš„GPUå·¥ä½œç«™ä¹Ÿå¾—å­¦ä¼šç”¨ï¼Œç»è¿‡å­¦é•¿çš„æ¨èï¼Œè¿˜æ˜¯æ‰“ç®—ç”¨VScodeè¿æœåŠ¡å™¨ã€‚åœ¨è¿æœåŠ¡å™¨ä¹‹å‰ï¼Œè®°å¾—å…ˆæ‰¾å®éªŒå®¤çš„è´Ÿè´£äººåˆ›å»ºç”¨æˆ·å¯†ç ã€‚ä¸‹é¢å°±æ˜¯æœ¬å°ç™½çš„é…ç½®è¿‡ç¨‹ï¼š

## å®‰è£…VScode

è¿™ä¸€æ­¥éš¾åº¦ä¸º0ï¼Œæˆ‘çŒœå¤§å®¶ç”µè„‘é‡ŒåŸºæœ¬éƒ½å·²ç»å®‰è£…äº†å§ã€‚ç°åœ¨VScodeä¸Šçš„æ’ä»¶å¾ˆå¤šï¼Œæˆ‘çš„æƒ³æ³•è¿˜æ˜¯æŠŠVScodeå½“ä½œä¸€ä¸ªç¼–è¾‘å™¨ï¼Œå¯ä»¥å°è¯•è£…$\LaTeX$å’ŒMarkdownä»¥åŠJupyter notebookä¹‹ç±»ï¼Œä¸è¦å®‰è£…å¤ªå¤šæ’ä»¶å½“IDEç”¨ï¼Œä¸»è¦æ˜¯æˆ‘æœ¬äººæ¯”è¾ƒå´‡å°šç®€å•è½»é‡ã€‚

## å®‰è£…Remote Developmentæ’ä»¶+é…ç½®SSH

æˆ‘çš„ç”µè„‘æ˜¯Macï¼Œæœ¬èº«è‡ªå¸¦sshï¼Œå®éªŒå®¤çš„Windowsç”µè„‘ï¼ˆwindows10è‡ªå¸¦powershellæ— éœ€å®‰è£…ï¼Œå…¶ä»–ç³»ç»Ÿå®‰è£…opensshï¼‰ã€‚Windowsç”µè„‘çš„è¿œç¨‹é…ç½®å’ŒMacåŸç†ä¸€æ ·ï¼Œéƒ½å·®ä¸å¤šï¼Œå¯ä»¥çœ‹å‚è€ƒé“¾æ¥ï¼Œå’ŒMacç”µè„‘çš„æ­¥éª¤åŸºæœ¬åªæœ‰è·¯å¾„ä¸åŒã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘æœ‰ä¸¤å°ç”µè„‘éƒ½æƒ³è¦è¿œç¨‹ç™»å½•æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæˆ‘åªéœ€è¦å°†ä¸¤å°ç”µè„‘çš„å…¬é’¥éƒ½æ·»åŠ åˆ°authorized_keysæ–‡ä»¶ä¸­ã€‚

å‚è€ƒï¼š[VSCodeè¿œç¨‹å¼€å‘é…ç½®æ•™ç¨‹](https://b23.tv/3YZFHhF)ï¼Œ[Macbook Airé…ç½®vscode+remote ssh](https://zhuanlan.zhihu.com/p/428127314)ï¼Œ[centosé…ç½®sshå…å¯†ç ç™»å½•åä»è¦è¾“å…¥å¯†ç çš„è§£å†³æ–¹æ³•](https://www.jb51.net/article/121180.htm)ï¼Œ[windows vscodeè¿œç¨‹è¿æ¥linuxæœåŠ¡å™¨](https://zhuanlan.zhihu.com/p/105707830)

Remote Developmentæ’ä»¶å®‰è£…åä¼šå°†æ‰€æœ‰ä½ éœ€è¦çš„è¿œç¨‹å¼€å‘çš„æ’ä»¶éƒ½å®‰è£…ä¸Šï¼ŒåŒ…æ‹¬Remote SSHã€‚

ä¸ºäº†è®©æˆ‘ä»¬ä¸è¦æ¯æ¬¡è¿æ¥æœåŠ¡å™¨éƒ½è¾“å…¥å¯†ç ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®sshå…¬é’¥å’Œç§é’¥ã€‚é¦–å…ˆåœ¨æœ¬åœ°ç”µè„‘Terminalä¸‹ç”Ÿæˆå¯†é’¥ï¼š

```zsh
ssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa-remote-ssh
```

 æ³¨æ„ç”Ÿæˆå¯†é’¥çš„è¿‡ç¨‹ä¸­å¯ä»¥ä¸è®¾passphraseï¼Œä¹‹å‰è®¾è¿‡ä¸€æ¬¡åœ¨åç»­è¿‡ç¨‹ä¸­æŠ¥è¿‡é”™ï¼Œç®€å•èµ·è§å¯ä»¥ç›´æ¥ä¸è®¾ã€‚è¿™æ—¶å¯ä»¥çœ‹åˆ°`~/.ssh`ä¸‹ç”Ÿæˆäº†`id_rsa-remote-ssh`å’Œ`id_rsa-remote-ssh.pub`ä¸¤ä¸ªæ–‡ä»¶ï¼Œå‰è€…æ˜¯æœ¬åœ°å¯†é’¥ï¼Œåè€…æ˜¯è¦ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„å…¬é’¥ã€‚

åœ¨æœ¬åœ°æ›´æ”¹`~/.ssh/config`æ–‡ä»¶ï¼Œå°†æ­¤æ–‡ä»¶åŠ ä¸Šï¼ˆä¸‹æ–¹çš„æ³¨é‡Šåªæ˜¯è§£é‡Šï¼Œä¸è¦æ”¾ä¸Šå»ï¼‰ï¼š

```c
Host XXXX   //Hoståï¼Œè®¾ç½®å¥½ä»¥åå¯ä»¥ç›´æ¥ç”¨ssh XXXXè¿æ¥
  User XXX			//ç”¨æˆ·å
  HostName XXXXXXXX   //æœåŠ¡å™¨åœ°å€
  IdentityFile ~/.ssh/id_rsa-remote-ssh   //æœ¬åœ°sshæ–‡ä»¶
```

ç”¨sshç™»å½•ç›®æ ‡æœåŠ¡å™¨ï¼Œåœ¨`~/.ssh`ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶`authorized_keys`ã€‚å°†`id_rsa-remote-ssh.pub`çš„å†…å®¹ç”¨catå‘½ä»¤æ‰“å¼€ï¼Œå¤åˆ¶ç²˜è´´åˆ°`authorized_keys`é‡Œï¼ˆæˆ‘ç”¨çš„vimï¼‰ã€‚æ‰¾åˆ°æœåŠ¡å™¨ç«¯çš„`/etc/ssh/sshd_config`æ–‡ä»¶å»æ‰`PubkeyAuthentication`å‰çš„æ³¨é‡Š`#`å·ã€‚ç„¶åé‡å¯è¿œç¨‹æœåŠ¡å™¨çš„sshæœåŠ¡ï¼š

```zsh
sudo systemctl restart sshd.service
```

æ¥ä¸‹æ¥å†ç™»å½•åº”è¯¥ä¸éœ€è¦å¯†ç ï¼Œå¦‚æœè¿˜éœ€è¦ï¼ˆæœ¬äººé‡åˆ°è¿™æ ·çš„äº‹æƒ…ï¼‰ï¼Œé‚£ä¹ˆè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š

æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼š

```zsh
tail /var/log/secure -n 20
```

ä»¥ä¸Šå‘½ä»¤å¯èƒ½éœ€è¦æƒé™ï¼Œå°±åŠ sudoå°±è¡Œã€‚

å¯ä»¥çœ‹åˆ°æœ€å20è¡Œçš„æ—¥å¿—ï¼Œå¦‚æœå…¶ä¸­æœ‰å¯¹æˆ‘ä»¬è‡ªå·±çš„ç™»å½•ä¿¡æ¯ï¼š`Authentication refused: bad ownership or modes for file`ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¿®æ”¹æƒé™ï¼š

```zsh
chmod g-w/home/yingzhang
chmod 700 /home/yingzhang/.ssh
chmod 600 /home/yingzhang/.ssh/authorized_keys
```

å†è¿›è¡Œç™»å½•å°±å¯ä»¥å…å¯†äº†ã€‚è¿™ä¸ªå¯ä»¥ç”¨Terminal check outä¸€ä¸‹ï¼Œå¦‚æœæˆåŠŸè®¾ç½®ï¼Œé‚£ä¹ˆä¸ç®¡åœ¨VScodeä¸Šç™»å½•è¿˜æ˜¯åœ¨Terminalä¸Šsshç™»å½•éƒ½æ˜¯å…å¯†çš„ã€‚

##åœ¨è¿œç¨‹æœåŠ¡å™¨å®‰è£…æ’ä»¶

ç™»å½•è¿œç¨‹æœåŠ¡å™¨åä¼šå‘ç°å¯ä»¥é€‰æ‹©å°†æ’ä»¶å®‰è£…åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šã€‚æˆ‘è§‰å¾—å¯ä»¥ä¸ç”¨ä¸“é—¨å®‰è£…ï¼Œåœ¨ä½ ä½¿ç”¨çš„è¿‡ç¨‹ä¸­VScodeä¼šå¼¹å‡ºæç¤ºæ¨èä½ å®‰è£…å“ªäº›æ’ä»¶ï¼ŒåŒ…æ‹¬Pythonï¼ŒJupyter notebookç­‰ï¼Œè¿™é‡Œåªä»‹ç»æˆ‘è§‰å¾—å¾ˆå¥½ç”¨ä¸€å®šè¦å®‰è£…çš„æ’ä»¶ï¼šSFTPã€‚

å‚è€ƒï¼š[VSCode SFTPæ’ä»¶è¯¦ç»†ä½¿ç”¨ä»‹ç»](https://blog.csdn.net/iamlujingtao/article/details/102501845)

SFTPå¯ä»¥è®©ä½ çš„æœ¬åœ°ä»£ç å’ŒæœåŠ¡å™¨ä»£ç åŒæ­¥ã€‚ä¸éœ€è¦å†å°†æ–‡ä»¶ä¼ æ¥ä¼ å»ã€‚éœ€è¦ä½ åœ¨æœ¬åœ°å®‰è£…SFTPæ’ä»¶ï¼ˆæ³¨æ„æ˜¯liximomoçš„ç‰ˆæœ¬ï¼‰ï¼Œç„¶åç”¨VScodeæ‰“å¼€ä½ æƒ³è¦åŒæ­¥çš„æ–‡ä»¶å¤¹ï¼Œç”¨`cmd+shift+P`è¾“å…¥`SFTP:CONFIG`ï¼Œå¯ä»¥ä»¥æ­¤ç¼–è¾‘`sftp.json`ã€‚æˆ‘çš„é…ç½®å¦‚ä¸‹ï¼š

```json
{
    "name": "3090",        		//æœåŠ¡å™¨åå­—ï¼Œéšä¾¿å–
    "host": "##.##.##.##",		//æœåŠ¡å™¨ipåœ°å€
    "protocol": "sftp",
    "port": 22,
    "username": "#########",	//ç”¨æˆ·å
    "remotePath": "/home/######/Signature-Verification_System_using_YOLOv5-and-CycleGAN",  //è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„è·¯å¾„
    "password": "######",		//å¯†ç 
    "uploadOnSave": true,
    "syncMode": "update",
    "watcher": {"files": "/*", "autoUpload": true, "autoDelete": true},
    "ignore": ["/.vscode"]
}
```

é…ç½®å¥½ä»¥åå¯ä»¥åœ¨æœ¬åœ°æ–‡ä»¶å¤„å³é”®ï¼Œé€‰æ‹©localâ€”>remoteå¯ä»¥å‘æœåŠ¡å™¨ä¸Šä¼ æ–‡ä»¶å¤¹ã€‚

## é…ç½®è¿œç¨‹æœåŠ¡å™¨ç¯å¢ƒ

æƒ³è¦åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè·‘æ·±åº¦å­¦ä¹ ï¼Œè¿˜éœ€è¦é…ç½®ã€‚æˆ‘ä»¬å¯ä»¥å…ˆæ£€æŸ¥ä¸€ä¸‹æœåŠ¡å™¨çš„GPUå‹å·å’Œæœ‰å‡ å—GPUï¼š

```bash
nvidia-smi -L
```

æ¥ä¸‹æ¥æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å·²ç»å®‰è£…äº†cudaå·²ç»cudaç‰ˆæœ¬ï¼š

```bash
nvcc -V
```

æˆ‘çš„æƒ…å†µæ˜¯å·²ç»å®‰è£…äº†cuda11.4ï¼ŒGPUæ˜¯ä¸€å—3090å¤§å®¶å…±ç”¨ã€‚æ¥ä¸‹æ¥æ£€æŸ¥ä¸€ä¸‹è‡ªå·±çš„ç”¨æˆ·æ–‡ä»¶å¤¹ä¸‹æœ‰æ²¡æœ‰condaæ–‡ä»¶å¤¹ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥è‚¯å®šå½“å‰æ²¡æœ‰è£…condaï¼ˆæˆ‘çš„æƒ…å†µï¼‰ï¼Œæ¥ä¸‹æ¥è¿˜æ˜¯è¦è£…condaï¼Œæˆ‘è¯•äº†ä¸€ä¸‹ä¸è£…condaç›´æ¥å¼€å§‹è¿è¡Œé¡¹ç›®ä»£ç ä¼šæŠ¥ä¸€äº›æ„æƒ³ä¸åˆ°çš„é”™ï¼Œä¸»è¦åŸå› å°±æ˜¯PyTorchï¼ŒPythonï¼Œcudaä»¥åŠæ˜¾å¡ç‰ˆæœ¬éƒ½æœ‰å¯èƒ½ç›¸äº’ä¸é€‚é…ã€‚condaè£…äº†ä»¥åå°±å¾ˆèˆ’æœå¾ˆæ–¹ä¾¿äº†ã€‚

å‚è€ƒï¼š[æœåŠ¡å™¨é…ç½®â€”â€”3090å¯¹åº”cudaå’Œtorchå®‰è£…](https://b23.tv/verKDLK)

minicondaæ˜¯condaçš„è½»é‡ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å…ˆè£…ä¸Šminicondaï¼š

```bash
wget -c https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh

chmod 777 Miniconda3-latest-Linux-x86_64.sh #ç»™æ‰§è¡Œæƒé™

bash Miniconda3-latest-Linux-x86_64.sh #è¿è¡Œ

cd ./home/ç”¨æˆ·å/miniconda3/bin

chmod 777 activate

. ./activate #æ¿€æ´»condaç¯å¢ƒ

conda config --add channels bioconda

conda config --add channels conda-forge #æ·»åŠ é¢‘é“

conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/

conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/

conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/

conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/  #è¿™å››æ¡æ˜¯æ·»åŠ channel

###ä¸‹ä¸€æ­¥æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œå¦åˆ™condaä¸èƒ½è¿è¡Œï¼ï¼ï¼ˆè¿™ä¸ªå‘½ä»¤ä¹Ÿæ˜¯å¸¸è§æ·»åŠ ç¯å¢ƒå˜é‡çš„å‘½ä»¤ï¼‰
###æˆ‘çš„å®‰è£…æƒ…å†µæ˜¯æ²¡æœ‰åŠ ï¼Œå› ä¸ºæ‰“å¼€~/.bashrcå‘ç°å·²ç»è‡ªåŠ¨åŠ ä¸Šäº†ã€‚

vim ~/.bashrc

export PATH=$PATH:/home/ç”¨æˆ·å/miniconda3/bin  #æ ¹æ®å®é™…è·¯å¾„ç¡®å®š

export PATH=$PATH:/home/user2/miniconda3/bin ï¼ˆè¿™æ˜¯æˆ‘çš„å‘½ä»¤ï¼‰

source ~/.bashrc #ä¿å­˜æ›´æ”¹
```

å› ä¸ºå·²ç»å®‰è£…äº†cudaï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦å®‰è£…PyTorchï¼Œå»PyTorchå®˜ç½‘çœ‹çœ‹ï¼Œå‘ç°æœ€è¿‘çš„ç‰ˆæœ¬1.10é€‚é…æ˜¯cuda11.3ï¼Œæ‰€ä»¥è£…ä¸€ä¸ª1.10å¯ä»¥äº†ï¼š

```bash
conda create -n torch1.10 python=3.8  # åˆ›å»ºäº†ä¸€ä¸ªPython3.8çš„ç¯å¢ƒï¼Œç¯å¢ƒåtorch1.10

conda activate torch1.10 #è¿›å…¥è™šæ‹Ÿç¯å¢ƒ

conda install pytorch torchvision torchaudio cudatoolkit=11.3 -c pytorch
```

äº²æµ‹è¿™ä¸ªç¯å¢ƒè·‘ä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚

## TBC-labmlï¼šç”¨æ‰‹æœºçœ‹æœåŠ¡å™¨ä¸Šçš„æ·±åº¦å­¦ä¹ è¿›ç¨‹

Githubï¼š[labml](https://github.com/labmlai/labml)