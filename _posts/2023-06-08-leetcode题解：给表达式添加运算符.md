---
layout: post

title: leetcodeé¢˜è§£ï¼šç»™è¡¨è¾¾å¼æ·»åŠ è¿ç®—ç¬¦

categories: leetcode ç®—æ³•

description: leetcodeé¢˜è§£

---

ğŸ”—ï¼š[ç»™è¡¨è¾¾å¼æ·»åŠ è¿ç®—ç¬¦](https://leetcode.cn/problems/expression-add-operators/)

è¿™é“é¢˜ç¡®å®æ˜¯å›°éš¾éš¾åº¦ã€‚æ€è·¯ä¸éš¾ï¼Œä½†æ˜¯ç»†èŠ‚ç‰¹åˆ«å¤šã€‚

çœ‹å®Œé¢˜ç›®ï¼Œé¦–å…ˆçš„ååº”å°±æ˜¯ç”¨å›æº¯æ¥è§£å†³ã€‚åœ¨ç”¨å›æº¯çš„æ—¶å€™ï¼Œè¦æ³¨æ„ï¼š

1. è¿ç®—ç¬¦æ˜¯æ”¾åœ¨æ•°å­—å‰è¿˜æ˜¯æ•°å­—åï¼Œå¦‚æœæ”¾åœ¨æ•°å­—å‰ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªæ•°å­—è¦ç‰¹æ®Šå¤„ç†ï¼›å¦‚æœæ”¾åœ¨æ•°å­—åï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªæ•°å­—è¦ç‰¹æ®Šå¤„ç†ã€‚æˆ‘è¿™æ¬¡é€‰æ‹©çš„æ˜¯æ”¾åœ¨æ•°å­—å‰ã€‚
2. åœ¨å›æº¯å‡½æ•°çš„å‚æ•°è®¾è®¡æ—¶ï¼Œè¦è€ƒè™‘å¥½æˆ‘ä»¬å›æº¯éœ€è¦å“ªäº›å‚æ•°ã€‚
3. æ˜¯è¾¹å›æº¯è¾¹è®¡ç®—æœ€ç»ˆç»“æœï¼Œè¿˜æ˜¯å°†å­—ç¬¦ä¸²ç»„ç»‡å®Œæˆå†è¿›è¡Œè®¡ç®—ã€‚æˆ‘ä¸ªäººæ¯”è¾ƒä¹ æƒ¯å°†å­—ç¬¦ä¸²ç»„ç»‡å®Œæˆå†è¿›è¡Œè®¡ç®—ï¼Œä½†æ˜¯åœ¨å®é™…åšé¢˜æ—¶å‘ç°ç»„ç»‡å®Œæˆåå†è®¡ç®—ä¼šè¶…æ—¶ï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯è¾¹å›æº¯è¾¹è®¡ç®—ï¼Œå¯ä»¥èŠ‚çœæ—¶é—´ã€‚
4. åœ¨ç»„ç»‡å­—ç¬¦ä¸²æ—¶éœ€è¦æ³¨æ„å‰ç½®0æ˜¯è¦æ’é™¤çš„ã€‚
5. æ€ä¹ˆè®°å½•trackï¼Œæ ¹æ®æˆ‘è¿™æ¬¡åšçš„ç»éªŒï¼Œå¦‚æœæ˜¯ä»ç©ºçš„å­—ç¬¦ä¸²push backçš„å¤æ‚åº¦ä¼šé«˜ä¸€äº›ã€‚é¢˜è§£çš„æ–¹æ³•å¾ˆå·§å¦™ï¼Œæ²¡æœ‰åŠæ³•ä¸€æ­¥æƒ³åˆ°ï¼Œéœ€è¦ä¼˜åŒ–åå»åšã€‚
6. åœ¨è¿ç®—è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæº¢å‡ºï¼Œæ‰€ä»¥ç”¨`long`æ¥å­˜å‚¨ä¸­é—´ç»“æœã€‚

æ•´ä¸ªbacktrackçš„æ¡†æ¶å¦‚ä¸‹ï¼š

```c++
void backtrack(string num, int target,string track,int idx, char op){
        if(idx==num.length()){
            if(compute(track,0,0,0)==target){
                res.push_back(track);
            }
            return;
        }
        if(idx==0){
            track.push_back(num[idx]);
            for(int i=0;i<4;++i){
                // æ’é™¤å‰ç½®0
                if(num[idx]=='0'&&i==0){
                    continue;
                }
                backtrack(num,target,track,idx+1,ops[i]);
            }
        }
        else{
            if(op!=' '){
                track.push_back(op);
            }
            track.push_back(num[idx]);
            // å½“idxä¸ºæœ€åä¸€ä½æ•°çš„æ—¶å€™ï¼Œä¸éœ€è¦å†éå†ops
            if(idx==num.length()-1){
                backtrack(num,target,track,idx+1,ops[0]);
            }
            else{
                for(int i=0;i<4;++i){
                    // æ’é™¤å‰ç½®0
                    if(op!=' '&&num[idx]=='0'&&i==0){
                        continue;
                    }
                    backtrack(num,target,track,idx+1,ops[i]);
                }
            }
        }
    }

vector<string> addOperators(string num, int target) {
    string track;
    ops=" +-*";
    // å› ä¸ºç¬¬ä¸€ä¸ªæ•°å­—ä¸ä¼šåŠ ä¸Šopï¼Œæ‰€ä»¥è¿™é‡Œæ”¾å“ªä¸ªopéƒ½å¯ä»¥
    backtrack(num,target,track,0,ops[0]);
    return res;
}
```

åœ¨æ‹¿åˆ°å­—ç¬¦ä¸²è¡¨è¾¾å¼åï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—è¡¨è¾¾å¼çš„ç»“æœä¸targetè¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆå¦‚ä½•è®¡ç®—å°±æˆä¸ºäº†ä¸€ä¸ªé—®é¢˜ã€‚æœ‰ä¸¤ä¸ªæ€è·¯ï¼Œä¸€ä¸ªæ˜¯ç”¨æ ˆæ¥è®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ç›´æ¥ä»å·¦å¾€å³é¡ºåºè®¡ç®—è¡¨è¾¾å¼ã€‚ç”¨æ ˆæ¥è®¡ç®—åº”è¯¥éƒ½æ¯”è¾ƒç†Ÿæ‚‰ï¼Œä½†æ˜¯æ ¹æ®æˆ‘è‡ªå·±åšé¢˜çš„ç»“æœæ¥çœ‹ï¼Œå¤æ‚åº¦ä¼šæ›´é«˜ã€‚ä¸‹é¢ä¸»è¦å†™ä»å·¦åˆ°å³è¿ç®—çš„æ–¹æ³•ã€‚

## ä»å·¦åˆ°å³é¡ºåºç®—è¡¨è¾¾å¼

å¦‚æœæƒ³ä»å·¦åˆ°å³é¡ºåºè®¡ç®—ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½æˆ‘ä»¬åœ¨è®¡ç®—è¿‡ç¨‹ä¸­è‡³å°‘éœ€è¦å‡ ä¸ªå‚æ•°ï¼š

| è¡¨è¾¾å¼    | cur               | prev      |
| --------- | ----------------- | --------- |
| 2         | 2                 | 2         |
| 2+51      | 2+51=53           | 51        |
| 2+51*3    | 53-51+51*3=155    | 51*3=153  |
| 2+51*3\*2 | 155-153+153*2=308 | 153*2=306 |

ç”±æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸Šè¿°æˆ‘ä»¬çš„åšæ³•æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºä¸€æ—¦ä¸èƒ½ç¡®å®šæ•°çš„ä½æ•°ï¼Œä¸¤ä¸ªå‚æ•°éƒ½ä¸å¤Ÿï¼Œå› æ­¤æˆ‘ä»¬å›æº¯æ—¶çš„é€‰æ‹©ä¸æ˜¯å››ä¸ªï¼Œè€Œæ˜¯åªæœ‰ä¸‰ä¸ªè¿ç®—ç¬¦ã€‚

## ç”¨push backè®°å½•trackæ¥å®ç° 

```c++
class Solution {
private:
    vector<string> ans;
    string ops;
public:
    void backtrack(string num,int target,string track,int idx,long cur,long prev){
        if(idx==num.length()){
            if(target==cur){
                ans.push_back(track);
            }
            return;
        }
        // ç¬¬ä¸€ä½ä¸èƒ½æ·»åŠ ç¬¦å·
        if(idx==0){
            long val=0;
            for(int i=idx;i<num.length();++i){
                if(num[idx]=='0'&&i>idx){
                    break;
                }
                val=val*10+num[i]-'0';
                track.push_back(num[i]);
                backtrack(num,target,track,i+1,val,val);
            }
        }
        else{
            for(int i=0;i<3;++i){
                // ç”¨tmpå­˜å‚¨å›æº¯ä¹‹å‰çš„trackçŠ¶æ€
                string tmp=track;
                track.push_back(ops[i]);
                long val=0;
                int j=idx;
                for(;j<num.length();++j){
                    // æ’é™¤å‰ç½®0
                    if(num[idx]=='0'&&j>idx){
                        break;
                    }
                    val=val*10+num[j]-'0';
                    track.push_back(num[j]);
                    if(ops[i]=='+'){
                        backtrack(num,target,track,j+1,cur+val,val);
                    }
                    else if(ops[i]=='-'){
                        backtrack(num,target, track,j+1,cur-val,-val);
                    }
                    else{
                        backtrack(num,target,track,j+1,cur-prev+prev*val,prev*val);
                    }
                }
                // åšå®Œé€‰æ‹©ï¼Œéœ€è¦è¿˜åŸtrack
                track=tmp;
            }
        }
    }
    vector<string> addOperators(string num, int target) {
        string track;
        ops="+-*";
        backtrack(num,target,track,0,0,0);
        return ans;
    }
};
```

